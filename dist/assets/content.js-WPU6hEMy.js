(function(){console.log("[FB Ads Analyzer] Content script loaded");chrome.runtime.onMessage.addListener((t,o,e)=>{if(t.action==="startScraping")console.log("[FB Ads Analyzer] Starting scraping process"),i(),e({status:"started"});else if(t.action==="loadData")console.log("[FB Ads Analyzer] Loading imported data"),r(t.data),e({status:"loaded"});else if(t.action==="checkExisting"){console.log("[FB Ads Analyzer] Checking for existing overlay");const n=!!document.getElementById("fbAdsAnalyzerOverlay");e({hasOverlay:n})}else if(t.action==="reopenOverlay"){console.log("[FB Ads Analyzer] Reopening overlay");const n=new CustomEvent("fbAdsReopen");document.dispatchEvent(n),e({status:"reopened"})}return!0});function i(){const t=document.createElement("script");t.src=chrome.runtime.getURL("src/injected.js"),t.onload=function(){this.remove()},(document.head||document.documentElement).appendChild(t);const o=document.createElement("script");o.src=chrome.runtime.getURL("src/visualizer.js"),o.onload=function(){this.remove()},(document.head||document.documentElement).appendChild(o);const e=document.createElement("link");e.rel="stylesheet",e.href=chrome.runtime.getURL("src/visualizer.css"),(document.head||document.documentElement).appendChild(e)}function r(t){if(document.getElementById("fbAdsAnalyzerOverlay")){console.log("[FB Ads Analyzer] Visualizer exists, sending data via CustomEvent");const c=new CustomEvent("fbAdsImportData",{detail:t});document.dispatchEvent(c);return}const e=document.createElement("div");e.id="fbAdsImportedData",e.style.display="none",e.textContent=JSON.stringify(t),document.body.appendChild(e);const n=document.createElement("script");if(n.src=chrome.runtime.getURL("src/visualizer.js"),n.onload=function(){this.remove()},(document.head||document.documentElement).appendChild(n),!document.querySelector('link[href*="visualizer.css"]')){const c=document.createElement("link");c.rel="stylesheet",c.href=chrome.runtime.getURL("src/visualizer.css"),(document.head||document.documentElement).appendChild(c)}}
})()
