console.log("[FB Ads Analyzer] Background script loaded");chrome.runtime.onMessage.addListener((s,o,e)=>{if(s.action==="analyzeAI")return c(s,e),!0});async function c(s,o){try{console.log("[Background] Starting AI Analysis...");const{apiKey:e,systemPrompt:a,userContent:r}=s.payload,n=await(await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({model:"gpt-4o",messages:[{role:"system",content:a},{role:"user",content:r}]})})).json();if(n.error)throw new Error(n.error.message);const t=n.choices[0].message.content;console.log("[Background] AI Analysis successful"),o({success:!0,analysis:t})}catch(e){console.error("[Background] AI Analysis failed:",e),o({success:!1,error:e.message})}}
